# fastapi服务器使用文档 {#1}

## 1.fastapi介绍
    
Fastapi是一个高性能web开发框架，他提供了很好的基础功能，让开发者不需要重复开发。其中一些功能如下：
1. **Pydantic**:
   - 用于数据验证和设置数据模型。Pydantic 提供了强大的数据验证功能，可以确保请求和响应的数据符合预期的格式。

2. **Starlette**:
   - FastAPI 是基于 Starlette 构建的，因此它继承了许多 Starlette 的功能，如路由、请求和响应、WebSocket 支持、中间件等。

3. **Path and Query Parameters**:
   - FastAPI 提供了简单的方式来定义路径参数和查询参数，并自动进行类型转换和验证。

4. **Dependency Injection**:
   - FastAPI 支持依赖注入，可以轻松地管理和注入依赖项，如数据库连接、配置等。

5. **Asynchronous Support**:
   - 支持异步编程，允许你编写异步的请求处理函数，以提高性能和响应速度。

6. **Automatic Interactive API Documentation**:
   - FastAPI 自动生成交互式 API 文档，支持 Swagger UI 和 ReDoc，方便开发者测试和了解 API。

7. **Security and Authentication**:
   - 提供了多种安全和认证机制，如 OAuth2、JWT 等，帮助开发者实现安全的 API。

8. **Background Tasks**:
   - 支持后台任务处理，可以在响应请求后执行一些耗时的操作而不阻塞主线程。

9. **CORS (Cross-Origin Resource Sharing)**:
   - 内置支持 CORS，允许配置跨域资源共享策略。

10. **Middleware**:
    - 支持中间件，可以在请求和响应的生命周期中插入自定义逻辑。

11. **WebSocket Support**:
    - 提供对 WebSocket 的支持，适用于实时通信应用。

12. **GraphQL**:
    - 可以通过集成第三方库来支持 GraphQL。


## 2.uvicorn介绍

fastapi是用来快速开发自己想要的应用。但是如何让这些应用程序跑起来并实际处理任务呢:question:

Uvicorn 是一个快速的 ASGI（Asynchronous Server Gateway Interface）服务器。它用于运行基于 ASGI 的 Python Web 应用程序。Uvicorn 是一个轻量级的服务器，支持异步编程，能够处理高并发请求。

异步和同步的关系:question:
- 同步: 在同步编程中，任务是按顺序执行的。一个任务必须完成后，才能开始下一个任务。这意味着如果一个任务需要等待某个操作（如 I/O 操作）完成，整个程序会被阻塞，直到该任务完成。
- 异步: 在异步编程中，任务可以在等待某个操作完成的同时继续执行其他任务。这意味着程序不会因为一个任务的等待而被阻塞。异步编程通常使用回调、Promise 或 async/await 等机制来处理任务的完成。

那异步是如何实现的呢，举个形象的例子就是，去早餐店买早饭，排队的人就是网络请求队列，假设早餐店只有一个员工，那么必然他的工作只能同步完成。如果有两个员工，那么就可以把点单和取餐分开，更快处理请求。

可是如果我只开一个uvicorn服务进程，即当不讨论多线程的情况下，那这边的异步意味着什么呢:question:
在linux中，最经典的模型即一切皆文件。那么除了你实际执行的代码运算，其余的皆可以被认为是对文件的读写操作即IO操作，那么一个应用程序中也不免大量存在这些IO操作即数据库查询，网络请求，文件读写，这些都是IO，操作系统给我们提供了IO的接口，如果当我们使用阻塞的方式访问这些接口时将在等待的过程中浪费很大的时间，如果应用程序有一个事件循环，将所有阻塞的IO换成非阻塞的IO，当调用IO时立即返回，处理其他事务，在IO完成后加入事件循环，在下一次循环中处理该事件请求，这样就将等待IO的时间也充分利用。

对于异步模型，线程调度与切换的代价比较高，对此协程应运而生，他是应用态程序的主动切换，这样就避免了线程切换代价，但是带来的则是需要显式的在程序中添加断点，```await```关键字则是python协程添加断点的操作。对于任意的异步接口都需要使用```await```等待其操作的结果。

## 3.项目介绍

本项目应用程序分为5个目录，分别为：
- apps
- classes
- core
- db
- models
其中apps对应的是提供给外部的接口，classes存放的是使用的功能类，core提供了一些通用功能组件：异步http请求接口，日志系统，db是数据库链接管理，models是ORM模型类定义的地方，还存放了一些pydantic里自动校验参数的BaseModel类定义